# soil-moisture-profile
The Exponential function used in this comparative analysis to deduce root-zone moisture content was developed by Wagner et al. (1999) and later refined into a recursive form by Albergel et al. (2008). It’s exponential decay function is based on a time lagged relationship between surface variations and the root-zone moisture content. The recursive formula for deducing root-zone moisture content is given as:
\begin{equation}
	SM_{rz(t)}^*=SM_{rz(t-1)}^*+K_t (SM_sfc^*-SM_{rz(t-1)}^*)	
 \end{equation}
 
SM* is the normalized SM content based on minimum and maximum moisture content over a period of time, rz and sfc refers to root-zone and surface values, respectively; t is the time (in days) and K is the gain function computed as:
	
  K_t=K_(t-1)/(K_(t-1)+e^((t_n-t_(n-1))/T) )	
  
T is the timescale of moisture variations in days while tn−(tn−1) is the difference in days the surface moisture content value was available between the current and previous time. At the start of the simulation or when the lag in data availability is greater than 12 days the model is re-initialized with SM_(rz(1))^*=SM_(sfc(1))^* and K(1) = 1 (Tobin et al., 2017). The surface (∼ 5 cm) moisture content input, SM_sfc^*, was obtained from the SCAN observations. The only unknown in this function is T which conceptually represents several parameters affecting temporal dynamics of the moisture content within a soil column (Ceballos et al., 2005). The accuracy of the exponential function is dependent on T (Albergel et al., 2008) and is usually calibrated to individual sites. Albergel et al. (2008) found little correlation between soil properties and T along with a weak relationship to climate (wind speed, ET, season); thus, an optimized T (Topt) is commonly determined by assessing the prediction accuracy using a metric over a calibration period. More specifically, the SM time series is simulated for the calibration period using all realistic values of T, then the objective function is calculated for the simulated time series against the observed data. The T value is optimized for each soil layer and the value that provides the best simulation for each soil layer is selected. This “brute-force” process can be applied to optimize T due to the quick computation time of the Exponential filter, the limited number of parameters being optimized, and the constrained dimension space of the parameter [typically 1 - ∼60 days (Qiu et al., 2014; Tobin et al., 2017)]. For this analysis, a two-year period (2010-2011) was used as spin-up to compute Topt for each test site and each layer separately. The Nash-Sutcliffe Efficiency (NSE) coefficient was used as the primary objective function; however, given the sensitivity of NSE to biases, an unbiased-RMSE (ubRMSE) was also used as a secondary objective function when optimizing Topt.

The POME model

Using Shannon Entropy (Shannon, 1948), the POME model by Al-Hamdan and Cruise (2010) was used in this study to develop vertical SM profiles. The model requires three inputs: boundary conditions (surface and bottom layer moisture content) along with the mean moisture content through the soil column. The model develops a monotonic profile subject to boundary conditions and constraints. The model uses two constraints: (a) the total probability constraint and (b) the mass balance constraint. The constraints are necessary to relate the first moment in probability space to the mean water content of the soil column in physical space. The main POME equation is given as:

Θ(z)=  (ln⁡[exp⁡(λ_2 Θ_0 )  ±〖 λ〗_2  exp⁡(1-λ_1)(z⁄L)])/λ_2 	
  
Here, Θ(z) is the effective moisture content at layer depth z, λ’s are the Lagrange multipliers, L is the total soil column depth. Θ0 is the surface effective SM. The Lagrange multipliers can be solved from application of the constraints and the boundary conditions. For complete model description and derivation please refer to Al-Hamdan and Cruise (2010).
In this study, the model was forced with boundary conditions at 5 and 100 cm depths, respectively using data from the SCAN observations. The profile mean moisture content was also computed from the SCAN observations. These inputs were used to obtain SM profiles at 5 cm depth increments from 0-100 cm. The model represents a monotonically increasing (+) or decreasing (-) function to develop dry or wet profiles, respectively. However, not all profiles are monotonic in nature, some tend to have at least one prominent inflection point (the dynamic case) (Mishra et al., 2015). The POME model identifies the dynamic case when the mean moisture content is outside the limits of the boundary condition and POME has no solution. The POME model can handle the profiles with inflection point by sub-dividing the profile into two monotonic profiles and applying the model over them separately. The presence of an inflection point poses another challenge in terms of input requirements, the depth as well as SM value at the inflection point are necessary. Inflection point location and value is a function of soil characteristics and moisture inputs from rainfall or irrigation. Mishra et al. (2015) suggest that for a given soil type, the inflection point does not vary much over time. Additionally, the study showed that for most of the soils (except extremely porous), the inflection point was typically present around 20 cm depth. In terms of SM value at the inflection point, they argued that for large scale applications, the initial inflection point value can be assumed as field capacity and can be used as a calibration parameter to achieve mass balance in each part of the profile. Therefore, in the spirit of minimum data input requirements, as would be the case within the remote sensing environment, for this study, the inflection point was assumed to be at 20 cm depths and an initial value was set as the field capacity. This value was iteratively reduced until the correct mass balance was achieved.
